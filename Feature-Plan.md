# Feature Plan: git-to-daily MVP

## Overview
Build a CLI tool that generates Obsidian daily logs from git commits.

## User Story
As a developer using Obsidian for project documentation,
I want to automatically generate daily logs from my git commits,
So that I save time and maintain consistent documentation.

## MVP Scope

### In Scope
✅ Parse commits from today
✅ Extract commit messages and changed files
✅ Generate markdown in Daily Log format
✅ Write to specified Obsidian vault path
✅ Basic error handling
✅ CLI command: `git-to-daily generate`

### Out of Scope (Future)
❌ Date range selection
❌ Author filtering
❌ Custom templates
❌ Append mode
❌ Git branch filtering

## Technical Design

### Architecture
```
┌─────────────┐
│  CLI Entry  │ (Agent 1)
│  (index.ts) │
└──────┬──────┘
       │
       ├─────────────────┐
       │                 │
       ▼                 ▼
┌─────────────┐   ┌─────────────┐
│ Git Parser  │   │  Generator  │ (Agent 1)
│ (git-parser)│   │ (generator) │
└─────┬───────┘   └──────┬──────┘
      │ (Agent 2)        │
      │                  │
      └──────────┬───────┘
                 ▼
          ┌─────────────┐
          │   Writer    │ (Agent 1)
          │  (writer)   │
          └─────────────┘
```

### Data Flow
```typescript
// 1. Get commits (Agent 2)
const commits = await gitParser.getTodaysCommits()

// 2. Generate markdown (Agent 1)
const markdown = generator.createDailyLog(commits)

// 3. Write file (Agent 1)
await writer.save(markdown, vaultPath)
```

## Agent Breakdown

### Agent 1: Core CLI & Generation (Primary)
**Responsibilities**:
- Set up project structure (package.json, tsconfig.json)
- Implement CLI using Commander.js
- Build markdown generator
- Build file writer
- Integrate with Agent 2's git parser

**Files**:
- `src/index.ts` - CLI entry point
- `src/generator.ts` - Markdown generation
- `src/writer.ts` - File operations
- `package.json` - Project config
- `tsconfig.json` - TypeScript config

**Tasks**:
1. Initialize npm project with TypeScript
2. Add dependencies (commander, simple-git)
3. Create CLI with `generate` command
4. Implement markdown generator (use Daily Log template)
5. Implement file writer (write to vault path)
6. Integrate with git parser
7. Add basic error handling

**Can start**: Immediately (use mock data for git commits initially)

### Agent 2: Git Integration (Supporting)
**Responsibilities**:
- Parse git repository
- Extract commits from today
- Format commit data for generator
- Define TypeScript interfaces

**Files**:
- `src/git-parser.ts` - Git operations
- `src/types.ts` - Shared types

**Tasks**:
1. Create TypeScript interfaces (Commit, FileChange, etc.)
2. Implement getTodaysCommits() using simple-git
3. Extract commit message, author, timestamp, files
4. Handle git errors gracefully
5. Export clean API for Agent 1

**Can start**: Immediately (parallel with Agent 1)

### Agent 3: Testing & Documentation (Finishing)
**Responsibilities**:
- Write unit tests
- Write integration tests
- Update documentation
- Create usage examples

**Files**:
- `tests/generator.test.ts`
- `tests/git-parser.test.ts`
- `tests/integration.test.ts`
- `README.md` (update with usage)
- `examples/` (sample outputs)

**Tasks**:
1. Test generator with various commit data
2. Test git parser with test repositories
3. Integration test: full flow
4. Document CLI usage in README
5. Create example output
6. Test error cases

**Can start**: After Agents 1 & 2 complete initial implementation

## Interfaces (Agent 2 defines, Agent 1 consumes)

```typescript
// src/types.ts
export interface Commit {
  hash: string
  message: string
  author: string
  timestamp: Date
  files: FileChange[]
}

export interface FileChange {
  path: string
  status: 'added' | 'modified' | 'deleted'
}

export interface DailyLogData {
  date: string
  commits: Commit[]
}

export interface Config {
  vaultPath: string
  projectName?: string
}
```

## Output Format

**Target**: Daily Log markdown following DevVault template

```markdown
# Daily Log - 2026-01-31

## Session Info
- **Date**: 2026-01-31
- **Duration**: [Calculated from commit times]
- **Focus Area**: [Inferred from commits]

## Work Completed
### Tasks
- ✅ [Commit message 1]
- ✅ [Commit message 2]

### Code Changes
- **Files Modified**:
  - `src/file1.ts` - [Commit message]
  - `src/file2.ts` - [Commit message]

### Commits
[Git log output]

## Generated by git-to-daily
This log was automatically generated from git commits.
```

## Configuration

**MVP**: CLI flag
```bash
git-to-daily generate --vault ~/DevVault --project my-app
```

**Future**: Config file (`.git-to-daily.json`)

## Testing Strategy

### Unit Tests
- `generator.test.ts`: Test markdown generation with mock data
- `git-parser.test.ts`: Test with test git repo

### Integration Test
- Create test git repo
- Make commits
- Run CLI
- Verify output file

### Manual Test
- Run on git-to-daily's own repository
- Verify output matches expected format

## Success Criteria
- [ ] Runs without errors on valid git repo
- [ ] Generates valid markdown
- [ ] Writes to correct vault location
- [ ] Completes in <5 seconds
- [ ] Handles "no commits today" gracefully
- [ ] Shows helpful error messages

## Coordination Points

### Agent 1 ↔ Agent 2
- **Handoff**: TypeScript interfaces defined in `types.ts`
- **Integration**: Agent 1 imports and calls Agent 2's parser
- **Communication**: Use Agent-Communication.md for interface changes

### Agents 1 & 2 → Agent 3
- **Handoff**: Create Handoff-To-Testing.md when implementation done
- **What Agent 3 needs**: Working build, documented API, example usage

## Timeline (Single Session)

**Hour 1**: Agents 1 & 2 work in parallel
- Agent 1: Project setup + CLI skeleton
- Agent 2: Git parser implementation

**Hour 2**: Integration
- Agent 1: Integrate git parser, implement generator
- Agent 2: Support integration, fix bugs

**Hour 3**: Testing & Polish
- Agent 3: Tests and documentation
- All: Bug fixes and refinement

## Risks & Mitigations

| Risk | Mitigation |
|------|------------|
| Different git configurations | Test on multiple repos |
| Path handling (Windows/Mac) | Use Node's path module |
| Large repos slow | Limit to today's commits only |
| File write permissions | Handle EACCES errors |

## Future Enhancements (Post-MVP)
1. Date range: `--since "3 days ago"`
2. Custom templates
3. Append mode (add to existing log)
4. Smart categorization (feat/fix/refactor)
5. Interactive mode
6. Config file support
7. Publish to npm

## Related Patterns
- CLI tool architecture
- TypeScript module organization
- Git repository operations
- Markdown generation
